â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š LEGEND MARKET SCANNER - SETUP & USAGE GUIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ WHAT THIS SCANNER DOES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. âœ… Scans 7000+ NSE & BSE stocks automatically
2. âœ… Detects MACD bullish crossovers (LATEST date only)
3. âœ… Confirms with 20 DMA and 50 DMA
4. âœ… Analyzes fundamentals (P/E, ROE, Growth)
5. âœ… Checks news sentiment
6. âœ… FILTERS: Only writes STRONG BUY/BUY to Google Sheets
7. âœ… Drops everything else (keeps your sheet clean!)


ğŸ” SIGNAL LOGIC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ STRONG BUY = MACD bullish crossover + Above 20 DMA + Above 50 DMA
ğŸ“Œ BUY = MACD bullish crossover + Above 20 DMA OR 50 DMA
ğŸ“Œ WATCH = MACD bullish crossover but below both MAs (NOT written to sheet)
ğŸ“Œ NO SIGNAL = No recent MACD crossover (NOT written to sheet)


ğŸ“Š OUTPUT COLUMNS IN GOOGLE SHEETS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Ticker (e.g., HAL.NS)
2. Company Name
3. Price (â‚¹)
4. Signal (STRONG BUY / BUY)
5. MACD Cross Date (e.g., 23-Jan-2026) â† LATEST crossover date
6. Days Ago (how recent the crossover was)
7. Above 20 DMA (Yes/No)
8. Above 50 DMA (Yes/No)
9. 20 DMA value
10. 50 DMA value
11. P/E Ratio
12. Market Cap
13. ROE (Return on Equity)
14. Profit Margin
15. Revenue Growth
16. Earnings Growth
17. Sentiment Score
18. Order Win? (Yes/No - detects "ORDER", "CONTRACT", "CRORE")
19. Top Headline
20. Last Updated (timestamp)


âš™ï¸ SETUP INSTRUCTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Install Required Libraries
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pip install yfinance pandas nltk gspread oauth2client numpy requests beautifulsoup4 --break-system-packages


STEP 2: Google Sheets Setup
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. You already have credentials.json (from previous setup)
2. Create a NEW Google Sheet named: "Legend Market Scanner"
3. Share it with your service account email (same as before)
4. Done!


STEP 3: Choose Scan Mode
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Open market_scanner_full.py and find this line (near the end):

    df = scan_market(all_stocks, max_stocks=100)

ğŸ“Œ TESTING MODE (recommended first run):
    max_stocks=100    â† Scans 100 stocks (~2 minutes)

ğŸ“Œ MEDIUM SCAN:
    max_stocks=1000   â† Scans 1000 stocks (~15 minutes)

ğŸ“Œ FULL MARKET SCAN:
    max_stocks=None   â† Scans ALL 7000+ stocks (~30-45 minutes)


ğŸš€ USAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RUN THE SCANNER:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python market_scanner_full.py


WHAT YOU'LL SEE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
====================================================================================================
ğŸ” LEGEND MARKET SCANNER - Scanning 1000 Stocks
====================================================================================================

ğŸ“Š Filtering for MACD Bullish Crossovers (Latest 30 days)
â±ï¸ This will take 15-30 minutes... Grab a coffee! â˜•

â³ Scanned 50/1000 stocks... (5.0%)
âœ… HAL.NS          | STRONG BUY   | Cross: 23-Jan-2026
âœ… BAIDFIN.NS      | STRONG BUY   | Cross: 23-Jan-2026
âœ… BAJAJCON.NS     | STRONG BUY   | Cross: 23-Jan-2026
â³ Scanned 100/1000 stocks... (10.0%)
...

====================================================================================================
âœ… SCAN COMPLETE!
ğŸ“Š Scanned: 1000 stocks
ğŸ¯ Found: 45 actionable opportunities
====================================================================================================

ğŸ“Š Connecting to Google Sheets...
âœ… Google Sheet updated successfully!
ğŸ”— Sheet: Legend Market Scanner

ğŸ’¾ Local backup saved: market_scan_20260128_170530.csv

====================================================================================================
ğŸ“ˆ SCAN SUMMARY:
====================================================================================================
ğŸ”¥ STRONG BUY: 32 stocks
âœ… BUY: 13 stocks
ğŸ“Š Total Opportunities: 45 stocks
====================================================================================================


â° WHEN TO RUN THE SCANNER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… RECOMMENDED SCHEDULE:

1. ğŸŒ… MORNING (9:30 AM) - After market opens
   â†’ Fresh data, catch overnight moves

2. ğŸŒ† EVENING (6:00 PM) - After market closes
   â†’ Full day's data, plan for tomorrow

3. ğŸ“… WEEKLY (Saturday/Sunday)
   â†’ Comprehensive scan, plan for the week


ğŸ¯ FILTERING LOGIC EXPLAINED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Q: Why only write STRONG BUY/BUY to Google Sheets?
A: To keep your sheet ACTIONABLE. You don't want to see 7000 stocks!
   Only the best opportunities make it to your sheet.

Q: What happens to stocks without MACD crossover?
A: They're DROPPED. Not written to the sheet at all.

Q: What if I want to see ALL stocks, even weak signals?
A: Edit line 540 in the code:
   
   CURRENT (only STRONG BUY/BUY):
   if result['Signal'] in ['STRONG BUY', 'BUY']:
   
   CHANGE TO (include WATCH):
   if result['Signal'] in ['STRONG BUY', 'BUY', 'WATCH']:


ğŸ“Š STOCK LIST SOURCES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

The scanner includes 1000+ most liquid stocks covering:

âœ… Defense & Aerospace
âœ… Infrastructure & Construction
âœ… Railways
âœ… IT & Technology (40 stocks)
âœ… Energy & Power
âœ… Banking & Finance (35 stocks)
âœ… Automobile
âœ… Pharmaceuticals (30 stocks)
âœ… FMCG & Retail
âœ… Metals & Mining
âœ… Cement
âœ… Chemicals
âœ… Textiles
âœ… Real Estate
âœ… Telecom
âœ… Media & Entertainment
âœ… Aviation & Tourism
âœ… Healthcare
âœ… Agriculture
âœ… Logistics
âœ… E-Commerce
âœ… Renewable Energy
âœ… Capital Goods
âœ… Paints & Coatings

Want MORE stocks? The scanner will try to fetch additional stocks from NSE API.


âš¡ PERFORMANCE TIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ FASTER SCANNING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Run during off-market hours (less API load)
2. Start with max_stocks=100 to test
3. Use good internet connection
4. Don't interrupt the scan

ğŸ¯ BETTER RESULTS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Run weekly for swing trades
2. Run daily for active trading
3. Combine with your own research
4. Check fundamentals before investing


ğŸ”§ TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ Error: "credentials.json not found"
â†’ Make sure credentials.json is in the same folder as the script

âŒ Error: "Sheet not found"
â†’ Create Google Sheet named exactly "Legend Market Scanner"
â†’ Share it with service account email

âŒ Error: "Rate limit exceeded"
â†’ Yahoo Finance limits requests. Wait 10 minutes and try again.
â†’ Or reduce max_stocks to scan fewer stocks

âŒ Scan is too slow
â†’ This is normal! 1000 stocks = ~15 minutes
â†’ Run overnight or while working on other tasks

âŒ No stocks found
â†’ Market might be in bearish trend
â†’ Try increasing lookback period (edit line 262: lookback_days=60)


ğŸ“ˆ EXAMPLE OUTPUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Your Google Sheet will look like this:

| Ticker | Company | Price | Signal | MACD Cross Date | Days Ago | 20MA | 50MA | P/E | ...
|--------|---------|-------|--------|-----------------|----------|------|------|-----|----
| HAL.NS | Hindustan Aeronautics | â‚¹4570 | STRONG BUY | 23-Jan-2026 | 5 | Yes | Yes | 35 | ...
| BAIDFIN.NS | Baid Finserv | â‚¹11.35 | STRONG BUY | 23-Jan-2026 | 5 | Yes | Yes | 12 | ...
| BAJAJCON.NS | Bajaj Consumer | â‚¹305.8 | STRONG BUY | 23-Jan-2026 | 5 | Yes | Yes | 28 | ...


ğŸ¯ NEXT STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Run the scanner: python market_scanner_full.py
2. Review results in Google Sheets
3. Do your own research on STRONG BUY stocks
4. Make informed investment decisions
5. Re-run scanner weekly/daily


âš ï¸ DISCLAIMER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

This scanner is a TOOL, not investment advice.
Always do your own research before investing.
Past performance does not guarantee future results.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•